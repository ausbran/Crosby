import{p as c,s as d,V as u,a as f,b as p,c as h,d as v}from"./purify.es-3Nu51a1Z.js";import{L as g}from"./LegacyUrl-CeiszSHN.js";import{n}from"./_plugin-vue2_normalizer-BFq-tfv7.js";const m=[{name:"__checkbox",titleClass:"center aligned",dataClass:"center aligned"},{name:"__component:legacy-url",sortField:"redirectSrcUrl",title:Craft.t("retour","Legacy URL Pattern"),titleClass:"center vuetable-th-redirectSrcUrl",dataClass:"center vuetable-td-redirectSrcUrl"},{name:"__component:redirect-to-url",sortField:"redirectDestUrl",title:Craft.t("retour","Redirect To"),titleClass:"center vuetable-th-redirectDestUrl",dataClass:"center vuetable-td-redirectDestUrl"},{name:"redirectMatchType",sortField:"redirectMatchType",title:Craft.t("retour","Match Type"),titleClass:"text-left",dataClass:"text-left",callback:"matchFormatter"},{name:"siteName",sortField:"siteId",title:Craft.t("retour","Sites"),titleClass:"text-left",dataClass:"text-left"},{name:"redirectHttpCode",sortField:"redirectHttpCode",title:Craft.t("retour","Status"),titleClass:"text-left",dataClass:"text-left"},{name:"__component:priority-value",sortField:"priority",title:Craft.t("retour","Priority"),titleClass:"text-right vuetable-th-priority",dataClass:"text-right vuetable-td-priority"},{name:"hitCount",sortField:"hitCount",title:Craft.t("retour","Hits"),titleClass:"text-right",dataClass:"text-right"},{name:"hitLastTime",sortField:"hitLastTime",title:Craft.t("retour","Last Hit"),titleClass:"center",dataClass:"center"}],b={props:{rowData:{type:Object,required:!0},rowIndex:{type:Number,default:0}},computed:{redirectDestUrl:function(){let t=this.rowData.redirectDestUrl;return t===""?"":(t=c.sanitize(t),t=encodeURI(t),t)},fullRedirectDestUrl:function(){let t=this.redirectDestUrl;return!new RegExp("^(?:[a-z]+:)?//","i").test(t)&&!t.includes("$")&&(t=Craft.getUrl(t.replace(/^\/+/g,""),null,this.rowData.siteBaseUrl)),t}}};var _=function(){var e=this,r=e._self._c;return r("div",[r("a",{staticClass:"go",attrs:{href:e.fullRedirectDestUrl,title:e.redirectDestUrl,rel:"noopener",target:"_blank"}},[e._v(e._s(e.redirectDestUrl))])])},C=[],x=n(b,_,C,!1,null,null);const T=x.exports,y={props:{rowData:{type:Object,required:!0},rowIndex:{type:Number,default:0}},computed:{priorityValue:function(){let t=this.rowData.priority;return this.rowData.redirectMatchType!=="regexmatch"&&(t="-"),t}}};var P=function(){var e=this,r=e._self._c;return r("span",[e._v(" "+e._s(e.priorityValue)+" ")])},$=[],w=n(y,P,$,!1,null,null);const U=w.exports;Vue.component("PriorityValue",U);Vue.component("LegacyUrl",g);Vue.component("RedirectToUrl",T);const D={components:{vuetable:h,"vuetable-pagination":p,"vuetable-pagination-info":f,"vuetable-filter-bar":u},mixins:[d],props:{siteId:{type:Number,default:0},apiUrl:{type:String,default:""}},data:function(){return{moreParams:{siteId:this.siteId},css:{tableClass:"data fullwidth retour-redirects",ascendingIcon:"icon retour-menubtn-asc",descendingIcon:"icon retour-menubtn-desc"},sortOrder:[{field:"hitCount",sortField:"hitCount",direction:"desc"}],fields:m,numSelected:0,selectedIds:[],filterText:"",perPage:20,stringPerPage:Craft.t("retour","Per-page:"),stringDelete:Craft.t("retour","Delete"),stringRedirect:Craft.t("retour","redirect"),stringRedirects:Craft.t("retour","redirects")}},computed:{csrfTokenName:function(){return window.Craft.csrfTokenName},csrfTokenValue:function(){return window.Craft.csrfTokenValue}},watch:{perPage:function(){this.$events.fire("refresh-table",this.$refs.vuetable)}},mounted(){this.$events.$on("filter-set",t=>this.onFilterSet(t)),this.$events.$on("filter-reset",()=>this.onFilterReset()),this.$refs.vuetable.$on("vuetable:checkbox-toggled",(t,e)=>this.onCheckboxToggled(t,e)),this.$refs.vuetable.$on("vuetable:checkbox-toggled-all",t=>this.onCheckboxToggled(t,null))},methods:{getSaveStateConfig(){return{cacheKey:"retour-redirects-state-v3-"+Craft.username+Craft.siteId,ignoreProperties:["numSelected","selectedIds","moreParams"]}},onFilterSet(t){this.filterText=t,this.moreParams={filter:this.filterText,siteId:this.siteId},this.$events.fire("refresh-table",this.$refs.vuetable)},onFilterReset(){this.filterText="",this.moreParams={filter:this.filterText,siteId:this.siteId},this.$events.fire("refresh-table",this.$refs.vuetable)},onPaginationData(t){this.$refs.paginationTop.setPaginationData(t),this.$refs.paginationInfoTop.setPaginationData(t),this.$refs.pagination.setPaginationData(t),this.$refs.paginationInfo.setPaginationData(t)},onChangePage(t){this.$refs.vuetable.changePage(t)},onCheckboxToggled(){this.numSelected=0,this.selectedIds=[],this.$refs.vuetable!==void 0&&this.$refs.vuetable.selectedTo!==void 0&&(this.numSelected=this.$refs.vuetable.selectedTo.length,this.selectedIds=this.$refs.vuetable.selectedTo)},matchFormatter(t){let e="Plugin Match";switch(t){case"exactmatch":e="Exact Match";break;case"regexmatch":e="RegEx Match";break}return e},deleteRedirectFormatter(t){return t===""?"":`
                <a class="delete icon" href="${t}" title="Delete"></a>
                `}}};var I=function(){var e=this,r=e._self._c;return r("div",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.numSelected!==0,expression:"numSelected !== 0"}]},[r("form",{attrs:{"accept-charset":"UTF-8",method:"post"}},[r("input",{attrs:{name:e.csrfTokenName,type:"hidden"},domProps:{value:e.csrfTokenValue}}),e._l(e.selectedIds,function(a){return r("input",{key:a,attrs:{name:"redirectIds[]",type:"hidden"},domProps:{value:a}})}),r("label",{staticClass:"text-gray-600"},[e._v(e._s(e.numSelected)+" "),e.numSelected===1?r("span",[e._v(e._s(e.stringRedirect))]):e._e(),e.numSelected!==1?r("span",[e._v(e._s(e.stringRedirects))]):e._e(),e._v(":")]),r("div",{staticClass:"btngroup inline"},[r("div",{staticClass:"ml-2 btn menubtn",attrs:{"data-icon":"settings"}}),r("div",{staticClass:"menu",attrs:{"data-align":"right"}},[r("ul",[r("li",[r("a",{staticClass:"formsubmit",attrs:{"data-action":"retour/redirects/delete-redirects"}},[e._v(e._s(e.stringDelete))])])])])])],2)]),r("vuetable-filter-bar",{directives:[{name:"show",rawName:"v-show",value:e.numSelected===0,expression:"numSelected === 0"}],attrs:{"initial-filter-text":e.filterText}}),r("div",{staticClass:"vuetable-pagination clearafter"},[r("vuetable-pagination-info",{ref:"paginationInfoTop"}),r("div",{staticClass:"floated left vuetable-pagination-info py-3"},[r("div",{staticClass:"inline pl-3 text-gray-600"},[e._v(" "+e._s(e.stringPerPage)+" ")]),r("div",{staticClass:"inline pl-3 text-gray-600"},[r("div",{staticClass:"select"},[r("select",{directives:[{name:"model",rawName:"v-model",value:e.perPage,expression:"perPage"}],staticClass:"fieldtoggle",attrs:{"data-target-prefix":"per-page-",name:"perPage"},on:{change:function(a){var l=Array.prototype.filter.call(a.target.options,function(s){return s.selected}).map(function(s){var o="_value"in s?s._value:s.value;return o});e.perPage=a.target.multiple?l:l[0]}}},[r("option",{attrs:{selected:"",value:"20"}},[e._v(" 20 ")]),r("option",{attrs:{value:"50"}},[e._v(" 50 ")]),r("option",{attrs:{value:"100"}},[e._v(" 100 ")]),r("option",{attrs:{value:"500"}},[e._v(" 500 ")])])])])]),r("vuetable-pagination",{ref:"paginationTop",on:{"vuetable-pagination:change-page":e.onChangePage}})],1),r("vuetable",{ref:"vuetable",attrs:{"api-url":e.apiUrl,"append-params":e.moreParams,css:e.css,fields:e.fields,"per-page":e.perPage,"sort-order":e.sortOrder},on:{"vuetable:pagination-data":e.onPaginationData}}),r("div",{staticClass:"vuetable-pagination clearafter border-solid"},[r("vuetable-pagination-info",{ref:"paginationInfo"}),r("vuetable-pagination",{ref:"pagination",on:{"vuetable-pagination:change-page":e.onChangePage}})],1)],1)},F=[],R=n(D,I,F,!1,null,null);const S=R.exports,i=window.Vue;i.use(v);new i({el:"#cp-nav-content",components:{"redirects-table":S},mounted(){this.$events.$on("refresh-table",t=>this.onTableRefresh(t))},methods:{onTableRefresh(t){i.nextTick(()=>t.refresh())}}});
//# sourceMappingURL=redirects-DvYaEq11.js.map
